!function(t){"use strict";function r(r){var e=t(r.currentTarget);if(!e.hasClass(l)){u.removeClass(l),e.addClass(l);var a=r.currentTarget.dataset.condition,o={pageUrl:location.href};t.cookie(f,a,{expires:365,path:"/"}),console.log(o),t.tmWcProductsAjax(o)}}function e(r){if(tmWooAjaxProducts.ajaxPagination){r.preventDefault();var e={pageUrl:r.currentTarget.href};t.tmWcProductsAjax(e)}}function a(r){r.preventDefault();var e=t(i),a=e.find(".product").length,c=t(r.currentTarget),n={pageUrl:r.currentTarget.dataset.href,action:"tm_wc_load_more",productsCount:a};c.addClass("loading"),t.post(tmWooAjaxProducts.ajaxurl,n,function(r){if(c.removeClass("loading"),r.success){var e=t(i);e.find(".product").last().after(r.data.products),c.replaceWith(r.data.button);var a=t.Event("tm_wc_products_changed");t(document).trigger(a),o()}})}function o(){t(c).off("change","select.orderby"),s=t(n),u=s.find(d),u.off("click"),u.on("click",function(t){r(t)}),t(c).on("change","select.orderby",function(r){t.tmWcOrderingHandler(r)}),t(m).off("click"),t(m).on("click",function(t){e(t)}),t(p).off("click"),t(p).on("click",function(t){a(t)})}var c=".woocommerce-ordering",n=".tm-woo-grid-list-toggle-button",d=".tm-woo-grid-list-toggler",i=".tm-wc-ajax-products-wrapper",s=t(n),u=s.find(d),l="disabled",f="tm-woo-grid-list",g=(t(i),t(".woocommerce-breadcrumb")),m="a.page-numbers",p="button.tm-wc-ajax-load-more-button";t.tmWcProductsAjax=function(r){var e=t(i);e.addClass("loading"),r.action="tm_wc_rebuild_products",r.wcbreadcrumbs=g.length,t.post(tmWooAjaxProducts.ajaxurl,r,function(a){if(e.removeClass("loading"),a.success){e.replaceWith(a.data.products);var c=t.Event("tm_wc_products_changed");for(var n in a.data.filters){var d=t("div[data-sidebar="+n+"]"),i=d.children(),s=0;a.data.filters[n].forEach(function(r,e,a){!1!==r.content?"undefined"!=typeof i[s]?i[s].id===r.id?(t(i[s]).replaceWith(r.content),c.widgets_updated=!0,s++):""!==r.content&&(t(i[s]).before(r.content),c.widgets_updated=!0,i=d.children(),s++):(t("div[data-sidebar="+n+"]").append(r.content),c.widgets_updated=!0,i=d.children()):s++})}a.data.wcbreadcrumbs&&g.replaceWith(a.data.wcbreadcrumbs),history.pushState&&location.href!==r.pageUrl&&history.pushState(null,null,r.pageUrl),t(document).trigger(c),o()}})},t.tmWcOrderingHandler=function(r){var e=t(r.currentTarget);if(!tmWooAjaxProducts.ajaxOrderby&&e.closest("form").hasClass("woocommerce-ordering"))return void e.closest("form").submit();var a,o=location.href,c=e.closest("form"),n=c.serialize(),d=location.search;a=d.length?o.replace(d,"?"+n):o+"?"+n;var i={pageUrl:a,task:"ordering"};t.tmWcProductsAjax(i)},t(document).ready(function(){o()})}(jQuery);